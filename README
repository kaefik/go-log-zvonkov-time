log zvonkov in Go lang

Программа написана на языке Golang и осуществляет отбор из сырого лога звонков выгруженного из Asterisk http://voip.2gis.local/cisco-stat/cdr.php по параметрам: номер телефона, подсчет общего количества звонков, количество уникальных номеров телефонов, по которым звонил менеджер, также количество пустых звонков (в программе указано менее 20 секунд), также количество результативных звонков (по умолчанию 20 секунд) и среднее время одного звонка. Также можно выгружать отчет по любому диапазону дат.  
Программа распространяется как есть…. 
Программа состоит из двух частей: 
Сама программа go-log-zvonkov-time.exe 
Файл параметров, по которым выгружается лог звонков: list-num-tel.cfg 
  
Текущую версию можно скачать здесь:  версия 3.0  

Предупреждение. Указывайте в файле list-num-tel.cfg уже в сгруппированном виде по РГ, т.е. сначала идут МПП первого РГП,далее второго РГП. В программе не выполняется сортировка при выгрузки лога и формировании результата. 
В результате работы программы генерируется лог работы программы go-log-zvonkov.log, и при успехе работы программы создаются логи звонков в форматах html  и xlsx. 
  
Что нового:
v.4.0   
Добавлены параметры otchet - флаг индивидуальных отчетов, если он не задан, то выгружается по умолчанию.
otchet="kazan" - результативный отчет выводится в новой форме (убран столбец общее кол-во звонков и добавлен столбец Плановое кол-во результативных звонков)
в файле параметров list-num-tel.cfg добавлен к каждой строке параметр, плановое кол-во результативных звонков для менеджера
Каждая строка следующего формата: 
Внутреннийномер;ФИОменеджера;ФИОРГ 
Например: 
15127;Моисеев Алексей;Рязанов Степан;30

v.3.0  
Добавлены параметры  ftime  и month. 
Параметр month удобен тем что когда запускаешь сервис последним днем месяца он выгружает итоговый лог с первого числа, т. о. получается за месяц. 
После каждой группы продаж подводится итог. 

v.2.0 
Добавлены параметры t1 и t2 
------ 

Параметры программы go-log-zvonkov-time.exe : 
-h  - выводит справку по параметрам программы 
  -d1   -  Начальная дата выгрузки лога звонков: YYYY-MM-DD 
  -d2    -  Конечная дата выгрузки лога звонков: YYYY-MM-DD 
  -fresult   -    длительность результативного звонка (в сек) – если он не задан, то по умолчанию 20 секунд 
  -week  -   Флаг недельной выгрузки: 1  (недельная выгрузка имеет следующую логику: если начало недели (ПН) не принадлежит текущему месяцу, то «начало недели считается 1 число текущего месяца») – у нас в филиале выгружается в пятницу каждой недели и рассылается РГ, вдруг кому пригодится. Если не нужна недельная выгрузка не используйте этот параметр., 
  -ftime  -   Флаг выгрузки разбивкой по времени: МСК 00:00-23:59, 9:00-9:30, 9:31-10:00, 10:01-10:30, 10:31-11:00, 11:01-11:30, 10:31-11:00, 11:01-11:30, 11:31-12:00, 12:01-23:59: 1 
  -month - Флаг выгрузки c первого дня месяца до текущей числа текущего месяца : 1 
-t1 –  Начальное время выгрузки лога звонков(время НСК): HH:MM 
-t2 –  Конечное время выгрузки лога звонков(время НСК): HH:MM 
Если –d1 и –d2 не заданы, то выгружается по текущей дате. 

Пример использования ключей: go-log-zvonkov-time.exe -month=1

Важно! Формат файла list-num-tel.cfg – если используете кирилицу, то файл сохраняйте в кодировке UTF-8 
Каждая строка следующего формата: 
Внутреннийномер;ФИОменеджера;ФИОРГ 
Например: 
15127;Моисеев Алексей;Рязанов Степан 
  
 auto-log-zvonkov.cmd -  пример батника как использовать лог звонков, его можно через планировщик запускать в нужное вам время 
manual-log-zvonkov.cmd  - пример батника выгрузки по заданному диапазону дат и времени 
  
Нашли ошибки или хочется еще каких-нибудь фишек пишем мне на почту ilnursoft@gmail.com  
Исходник на сервис лежит в гитхабе по ссылке https://github.com/kaefik/go-log-zvonkov-time  